<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Emily01news News</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .post { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; border-radius: 8px; }
    .comment { margin-left: 20px; font-size: 14px; color: #333; }
    button { margin-top: 5px; }
  </style>
</head>
<body>

  <h1>Emily01news News</h1>

  <div class="post" id="post1">
    <p>Este é um post de exemplo.</p>
    <button class="like-btn">Curtir <span id="like-count">0</span></button>
    <div class="comments">
      <input type="text" placeholder="Escreva um comentário" class="comment-input">
      <button class="comment-btn">Comentar</button>
      <div class="comment-list"></div>
    </div>
  </div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, updateDoc, doc, query, onSnapshot } 
      from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBjnSLKBdpz13_9jxlqwnQRNLXNtfPoq9o",
      authDomain: "emily01-ab49c.firebaseapp.com",
      projectId: "emily01-ab49c",
      storageBucket: "emily01-ab49c.firebasestorage.app",
      messagingSenderId: "955907136214",
      appId: "1:955907136214:web:516ea542ebb20e70f18777"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Referências
    const postId = "post1";
    const likeBtn = document.querySelector(".like-btn");
    const likeCountSpan = document.getElementById("like-count");
    const commentBtn = document.querySelector(".comment-btn");
    const commentInput = document.querySelector(".comment-input");
    const commentList = document.querySelector(".comment-list");

    // Curtidas - atualizar e salvar
    likeBtn.addEventListener("click", async () => {
      const docRef = doc(db, "posts", postId);
      await updateDoc(docRef, { likes: (parseInt(likeCountSpan.textContent) + 1) });
    });

    // Comentários - salvar
    commentBtn.addEventListener("click", async () => {
      const text = commentInput.value.trim();
      if (text !== "") {
        await addDoc(collection(db, "posts", postId, "comments"), {
          text: text,
          createdAt: new Date()
        });
        commentInput.value = "";
      }
    });

    // Mostrar curtidas em tempo real
    onSnapshot(doc(db, "posts", postId), (docSnap) => {
      if (docSnap.exists()) {
        likeCountSpan.textContent = docSnap.data().likes || 0;
      }
    });

    // Mostrar comentários em tempo real
    onSnapshot(collection(db, "posts", postId, "comments"), (snapshot) => {
      commentList.innerHTML = "";
      snapshot.forEach(doc => {
        const c = document.createElement("div");
        c.className = "comment";
        c.textContent = doc.data().text;
        commentList.appendChild(c);
      });
    });
  </script>

</body>
</html>
